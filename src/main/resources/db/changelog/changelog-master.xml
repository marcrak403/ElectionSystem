<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-5.0.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1765983271147-1" author="Marcin">
        <createTable tableName="election">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_election"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT"/>
            <column name="start_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="end_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="VARCHAR(20)">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1765983271147-2" author="Marcin">
        <createTable tableName="election_option">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_electionoption"/>
            </column>
            <column name="election_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="option_title" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT"/>
            <column name="display_order" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1765983271147-3" author="Marcin">
        <createTable tableName="vote">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_vote"/>
            </column>
            <column name="election_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="election_option_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="voted_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1765983271147-4" author="Marcin">
        <createTable tableName="voter">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_voter"/>
            </column>
            <column name="email" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="password" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="first_name" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="last_name" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="pesel" type="VARCHAR(11)"/>
            <column name="role" type="VARCHAR(20)">
                <constraints nullable="false"/>
            </column>
            <column name="active" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1765983271147-5" author="Marcin">
        <createTable tableName="voting_record">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_votingrecord"/>
            </column>
            <column name="voter_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="election_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="voted_at" type="DATETIME">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1765983271147-6" author="Marcin">
        <addUniqueConstraint columnNames="email" constraintName="uc_voter_email" tableName="voter"/>
    </changeSet>
    <changeSet id="1765983271147-7" author="Marcin">
        <addUniqueConstraint columnNames="pesel" constraintName="uc_voter_pesel" tableName="voter"/>
    </changeSet>
    <changeSet id="1765983271147-8" author="Marcin">
        <addForeignKeyConstraint baseColumnNames="election_id" baseTableName="election_option"
                                 constraintName="FK_ELECTIONOPTION_ON_ELECTION" referencedColumnNames="id"
                                 referencedTableName="election"/>
    </changeSet>
    <changeSet id="1765983271147-9" author="Marcin">
        <addForeignKeyConstraint baseColumnNames="election_id" baseTableName="vote" constraintName="FK_VOTE_ON_ELECTION"
                                 referencedColumnNames="id" referencedTableName="election"/>
    </changeSet>
    <changeSet id="1765983271147-10" author="Marcin">
        <addForeignKeyConstraint baseColumnNames="election_option_id" baseTableName="vote"
                                 constraintName="FK_VOTE_ON_ELECTION_OPTION" referencedColumnNames="id"
                                 referencedTableName="election_option"/>
    </changeSet>
    <changeSet id="1765983271147-11" author="Marcin">
        <addForeignKeyConstraint baseColumnNames="election_id" baseTableName="voting_record"
                                 constraintName="FK_VOTINGRECORD_ON_ELECTION" referencedColumnNames="id"
                                 referencedTableName="election"/>
    </changeSet>
    <changeSet id="1765983271147-12" author="Marcin">
        <addForeignKeyConstraint baseColumnNames="voter_id" baseTableName="voting_record"
                                 constraintName="FK_VOTINGRECORD_ON_VOTER" referencedColumnNames="id"
                                 referencedTableName="voter"/>
    </changeSet>

</databaseChangeLog>